epochs = 20
batch_size = 100
learning_rate = 0.01  

Training CNN on MNIST data...
Loading MNIST data...
Training images: 60000
Test images: 10000
Starting training...

Epoch 1/20
Batch 1/20, Loss: 2.2310
Batch 6/20, Loss: 1.1162
Batch 11/20, Loss: 0.9360
Batch 16/20, Loss: 0.8453
Epoch 1 - Test accuracy: 0.8005
New best accuracy: 0.8005

Epoch 2/20
Batch 1/20, Loss: 0.7719
Batch 6/20, Loss: 0.7431
Batch 11/20, Loss: 0.7344
Batch 16/20, Loss: 0.6608
Epoch 2 - Test accuracy: 0.8120
New best accuracy: 0.8120

Epoch 3/20
Batch 1/20, Loss: 0.6904
Batch 6/20, Loss: 0.6852
Batch 11/20, Loss: 0.6567
Batch 16/20, Loss: 0.6398
Epoch 3 - Test accuracy: 0.8231
New best accuracy: 0.8231

Epoch 4/20
Batch 1/20, Loss: 0.6180
Batch 6/20, Loss: 0.6345
Batch 11/20, Loss: 0.6636
Batch 16/20, Loss: 0.5723
Epoch 4 - Test accuracy: 0.8441
New best accuracy: 0.8441

Epoch 5/20
Batch 1/20, Loss: 0.5385
Batch 6/20, Loss: 0.5366
Batch 11/20, Loss: 0.6010
Batch 16/20, Loss: 0.6124
Epoch 5 - Test accuracy: 0.8590
New best accuracy: 0.8590

Epoch 6/20
Batch 1/20, Loss: 0.5112
Batch 6/20, Loss: 0.5593
Batch 11/20, Loss: 0.5562
Batch 16/20, Loss: 0.6191
Epoch 6 - Test accuracy: 0.8613
New best accuracy: 0.8613

Epoch 7/20
Batch 1/20, Loss: 0.5952
Batch 6/20, Loss: 0.6213
Batch 11/20, Loss: 0.5645
Batch 16/20, Loss: 0.5207
Epoch 7 - Test accuracy: 0.8659
New best accuracy: 0.8659

Epoch 8/20
Batch 1/20, Loss: 0.5123
Batch 6/20, Loss: 0.6165
Batch 11/20, Loss: 0.5029
Batch 16/20, Loss: 0.5787
Epoch 8 - Test accuracy: 0.8795
New best accuracy: 0.8795

Epoch 9/20
Batch 1/20, Loss: 0.5420
Batch 6/20, Loss: 0.5478
Batch 11/20, Loss: 0.4988
Batch 16/20, Loss: 0.5607
Epoch 9 - Test accuracy: 0.8776
No improvement. Patience: 1/3

Epoch 10/20
Batch 1/20, Loss: 0.5753
Batch 6/20, Loss: 0.5674
Batch 11/20, Loss: 0.4997
Batch 16/20, Loss: 0.5452
Epoch 10 - Test accuracy: 0.8785
No improvement. Patience: 2/3
Reducing learning rate to: 0.0050

Epoch 11/20
Batch 1/20, Loss: 0.5532
Batch 6/20, Loss: 0.4670
Batch 11/20, Loss: 0.5593
Batch 16/20, Loss: 0.5238
Epoch 11 - Test accuracy: 0.8872
New best accuracy: 0.8872

Epoch 12/20
Batch 1/20, Loss: 0.4772
Batch 6/20, Loss: 0.4535
Batch 11/20, Loss: 0.4173
Batch 16/20, Loss: 0.4802
Epoch 12 - Test accuracy: 0.8848
No improvement. Patience: 1/3

Epoch 13/20
Batch 1/20, Loss: 0.4960
Batch 6/20, Loss: 0.4345
Batch 11/20, Loss: 0.4847
Batch 16/20, Loss: 0.4669
Epoch 13 - Test accuracy: 0.8869
No improvement. Patience: 2/3
Reducing learning rate to: 0.0025

Epoch 14/20
Batch 1/20, Loss: 0.4030
Batch 6/20, Loss: 0.4964
Batch 11/20, Loss: 0.4565
Batch 16/20, Loss: 0.4559
Epoch 14 - Test accuracy: 0.8868
No improvement. Patience: 3/3
Early stopping triggered!

Training completed! Best accuracy: 0.8872
Training completed!